CREATE TABLE CUSTOMERUSER(
USERID INTEGER PRIMARY KEY,
FIRSTNAME VARCHAR2(30),
LASTNAME VARCHAR2(30),
USERNAME VARCHAR2(30) UNIQUE,
PASSWORD1 VARCHAR2(30)
);

CREATE TABLE INDIVIDUALACCOUNT(
ACCOUNTNUM INTEGER PRIMARY KEY,
USERID INTEGER,
ACCOUNTBAL FLOAT(126)
);


CREATE SEQUENCE USERSEQ
MINVALUE 1001
MAXVALUE 9999
START WITH 1001
INCREMENT BY 1
CACHE 20;

CREATE SEQUENCE ACCOUNTSEQ
MINVALUE 2328792
MAXVALUE 9999999
START WITH 2328792
INCREMENT BY 1
CACHE 20;

CREATE OR REPLACE PROCEDURE CREATEINDIVIDUALACCOUNT(USERID IN INTEGER, ACCOUNTBAL IN FLOAT)
AS
BEGIN
INSERT INTO INDIVIDUALACCOUNT VALUES(ACCOUNTSEQ.NEXTVAL, USERID, ACCOUNTBAL);
COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE INSERTUSER(FIRSTNAME IN VARCHAR2, LASTNAME IN VARCHAR2, USERNAME IN VARCHAR2, PASSWORD1 IN VARCHAR2)
AS
BEGIN
INSERT INTO CUSTOMERUSER VALUES(USERSEQ.NEXTVAL, FIRSTNAME, LASTNAME, USERNAME, PASSWORD1);
COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE GETUSERID
(U_NAME IN VARCHAR2, P_WORD IN VARCHAR2)
RETURN SYS_REFCURSOR IS
USER_ID SYS_REFCURSOR;
BEGIN
    OPEN USER_ID FOR
    SELECT USERID FROM CUSTOMERUSER WHERE USERNAME = U_NAME AND PASSWORD1 = P_WORD;
    RETURN USER_ID;
END;
/

CREATE OR REPLACE PROCEDURE ADDTOBALANCE(USER_ID IN INTEGER, DEPOSITAMOUNT IN FLOAT)
AS
BEGIN
    UPDATE INDIVIDUALACCOUNT SET ACCOUNTBAL = DEPOSITAMOUNT WHERE USERID = USER_ID;
COMMIT;
END;
/


SELECT * FROM INDIVIDUALACCOUNT;

SELECT * FROM CUSTOMERUSER;

DROP TABLE INDIVIDUALACCOUNT;
DROP TABLE CUSTOMERUSER;