CREATE SEQUENCE CUSTOMERSEQ;
CREATE SEQUENCE ACCOUNTSEQ;

CREATE TABLE BANKCUSTOMER(
CUSTOMERID NUMBER(10) PRIMARY KEY,
CUSTOMERUSERNAME VARCHAR2(20),
CUSTOMERPASS VARCHAR2(20),
FIRSTNAME VARCHAR2(20),
LASTNAME VARCHAR2(20));

CREATE TABLE BANKACCOUNT(
ACCOUNTID NUMBER(10),
BALANCE NUMBER(10,2),
CUSTOMERID NUMBER(10));

ALTER TABLE BANKACCOUNT
ADD CONSTRAINT FK_CUSTOMERID
FOREIGN KEY (CUSTOMERID) REFERENCES BANKCUSTOMER(CUSTOMERID);

/*
DROP TABLE BANKCUSTOMER;
DROP TABLE BANKACCOUNT;
*/

CREATE OR REPLACE PROCEDURE INSERTUSER(CUSTOMERUSERNAME IN VARCHAR2, CUSTOMERPASS IN VARCHAR2, FIRSTNAME IN VARCHAR2, LASTNAME IN VARCHAR2)
AS
BEGIN
    INSERT INTO BANKCUSTOMER VALUES(CUSTOMERSEQ.NEXTVAL, CUSTOMERUSERNAME, CUSTOMERPASS, FIRSTNAME, LASTNAME);
    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE INSERTACCOUNT(ACCOUNTBALANCE IN NUMBER, CUSTOMERID IN NUMBER)
AS
BEGIN
    INSERT INTO BANKACCOUNT VALUES(ACCOUNTSEQ.NEXTVAL, ACCOUNTBALANCE, CUSTOMERID);
    COMMIT;
END;
/


CREATE OR REPLACE PROCEDURE DEPOSIT(DEPOSITACCOUNT IN NUMBER, DEPOSITVALUE IN NUMBER)
AS
BEGIN
    UPDATE BANKACCOUNT SET BALANCE = BALANCE + DEPOSITVALUE WHERE ACCOUNTID = DEPOSITACCOUNT;
    INSERT INTO TRANSACTIONS VALUES(DEPOSITACCOUNT, 'DEPOSIT', DEPOSITVALUE);
COMMIT;
END;
/
--EXECUTE DEPOSIT(1,20);

CREATE OR REPLACE PROCEDURE WITHDRAW(WITHDRAWACCOUNT IN NUMBER, WITHDRAWVALUE IN NUMBER)
AS
BEGIN
    UPDATE BANKACCOUNT SET BALANCE = BALANCE - WITHDRAWVALUE WHERE ACCOUNTID = WITHDRAWACCOUNT;
    INSERT INTO TRANSACTIONS VALUES(WITHDRAWACCOUNT, 'WITHDRAWAL', WITHDRAWVALUE);
COMMIT;
END;
/

CREATE TABLE TRANSACTIONS(
ACCOUNTID NUMBER(10),
TRANSACTIONTYPE VARCHAR(20),
VALUE NUMBER(10,2));
